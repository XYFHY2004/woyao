<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>大屏幕</title>
</head>
<link rel="stylesheet" href="./show.css">
<script src="./jquery-1.9.1/jquery.min.js"></script>
<body>
<div class="l-code">
    <img class="msg-img" src="./img/head.jpg" alt="">
</div>
<div class="m-contain">
    <div class="m-top">
        音乐小房子酒吧
    </div>
    <div class="m-msg-ctn">
        <div class="msg-block m0">
            <div class="msg-h">
                <img class="msg-hd" src="./img/head.jpg" alt="">
            </div>
            <div class='msg-c'>
                <div class="msg-name">隔壁老王 <img src="./img/woman.png" alt=""></div>
                <div class="msg-text">
                    <div class="msg-img-c">
                        <img class="msg-img" src="./img/head.jpg" alt="">
                    </div>
                    <div class="msg-text-c">
                        我要霸屏！
                    </div>
                </div>
            </div>
        </div>
        <div class="msg-block m1">
            <div class="msg-h">
                <img class="msg-hd" src="./img/head.jpg" alt="">
            </div>
            <div class='msg-c'>
                <div class="msg-name">隔壁老王 <img src="./img/woman.png" alt=""></div>
                <div class="msg-text">
                    <div class="msg-img-c">
                        <img class="msg-img" src="./img/head.jpg" alt="">
                    </div>
                    <div class="msg-text-c">
                        我要霸屏！
                    </div>
                </div>
            </div>
        </div>
        <div class="msg-block m2">
            <div class="msg-h">
                <img class="msg-hd" src="./img/head.jpg" alt="">
            </div>
            <div class='msg-c'>
                <div class="msg-name">隔壁老王 <img src="./img/woman.png" alt=""></div>
                <div class="msg-text">
                    <div class="msg-img-c" style="display: none">
                        <img class="msg-img" src="./img/head.jpg" alt="">
                    </div>
                    <div class="msg-text-c">
                        我要霸屏！
                    </div>
                </div>
            </div>
        </div>
        <div class="msg-block m3">
            <div class="msg-h">
                <img class="msg-hd" src="./img/head.jpg" alt="">
            </div>
            <div class='msg-c'>
                <div class="msg-name">隔壁老王 <img src="./img/woman.png" alt=""></div>
                <div class="msg-text">
                    <div class="msg-img-c" style="display: none">
                        <img class="msg-img" src="./img/head.jpg" alt="">
                    </div>
                    <div class="msg-text-c">
                        我要霸屏！
                    </div>
                </div>
            </div>
        </div>
        <div class="msg-block m4">
            <div class="msg-h">
                <img class="msg-hd" src="./img/head.jpg" alt="">
            </div>
            <div class='msg-c'>
                <div class="msg-name">隔壁老王 <img src="./img/woman.png" alt=""></div>
                <div class="msg-text">
                    <div class="msg-img-c" style="display: none">
                        <img class="msg-img" src="./img/head.jpg" alt="">
                    </div>
                    <div class="msg-text-c">
                        我要霸屏！
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
<script>
    window.onload = function () {

        var socket = undefined;
        // 创建一个Socket实例
        var isHttps = ('https:' == window.location.protocol);
        var protocol = 'ws://';
        if (isHttps) {
            protocol = 'wss://';
        }
        socket = new WebSocket(protocol + window.location.host + '/mobile/chat/socket');

        // 打开Socket
        socket.onopen = function(event) {
            console.log("聊天室连接成功");
        };

        socket.onmessage = function(message) {
            var msg = JSON.parse(message.data);
            console.log("get masage:");
            console.log(msg);

            if(msg.command == 'err'){
                alert(msg.reason);
                return
            }
            if(msg.command == 'selfInfo'){
                return;
            }
            if(msg.command == 'roomInfo'){
                return;
            }
            if(msg.command == 'prePay'){

            }
        };

        
        var allMsgList = [{name:'pp1',msg:'pp1',pic:'./img/portrait.png'},{name:'pp2',msg:'pp2',pic:'./img/portrait.png'},{name:'pp3',msg:'pp3',pic:'./img/portrait.png'}];
        var allMsgIndex = 0;

        //轮播部分
        var msgLi=$('.msg-block');
        var msgClassArr = ["m0","m1","m2","m3","m4"];
        function allAdd(){
            var last=msgClassArr.pop();
            msgClassArr.unshift(last);
            for (var i = 0; i < msgClassArr.length; i++) {
                msgLi[i].className = msgClassArr[i];
            }
            if(allMsgIndex == allMsgList.length - 1){
                allMsgIndex = 0;
            }else{
                allMsgIndex++;
            }
            var changeBlock = $('.m4');
//            changeBlock.find('.chat-text-img').attr('src',msgList[allMsgIndex].pic);
//            changeBlock.find('.right-name').html(msgList[allMsgIndex].name);
//            changeBlock.find('.right-tip').html(msgList[allMsgIndex].msg);
        }
        window.setInterval(function(){
            allAdd();
        },2000);
    }

</script>
</html>